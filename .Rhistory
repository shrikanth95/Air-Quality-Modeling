conc.1hr <- array(0, len)
desea <- array(0, len)
time.day <- array(0, len)#.POSIXct(character(len))
for(i in 1:length(desea.split)){
desea.var.1hr[i] = var(desea.split[[i]])
conc.var.1hr[i] = var(conc.split[[i]])
desea[i] = mean(desea.split[[i]])
conc.1hr[i] = mean(conc.split[[i]])
time.day[i] <- hour(start(conc.split[[i]]))
}
df.var.1 <- data.frame(time = time.day, conc = conc.1hr, de.var = desea.var.1hr, conc.var = conc.var.1hr)
df.var.2 <- data.frame(time = time.day, desea = desea, de.var = desea.var.1hr, conc.var = conc.var.1hr)
ggplot(df.var.2, aes(x = timme, y = desea)) + geom_point(size = 1.5) + geom_line(size = 1)
ggplot(df.var.2, aes(x = time, y = desea)) + geom_point(size = 1.5) + geom_line(size = 1)
View(df.var.2)
df.var.1 <- data.frame(time = time.day, conc = conc.1hr, de.var = desea.var.1hr, conc.var = conc.var.1hr)
df.var.2 <- data.frame(time = time.day, desea = desea, de.var = desea.var.1hr, conc.var = conc.var.1hr)
View(df.var.1)
plot(df.var.2$desea)
ggplot(df.var.2, aes(x = 1:nrow(df.var.2), y = desea)) + geom_point(size = 1.5) + geom_line(size = 1)
ggplot(df.var.2, aes(x = time, y = desea)) + geom_point(size = 1.5) #+ geom_line(size = 1)
desea.var.1hr
desea.split
View(desea.split)
avg_time <- 1/6
df.specs = "NV_conc_char"
df.new <- getMasterdf_September(avg_time)
tmp <- avg_time
avg_time <- 1/6
df.specs = "NV_conc_char"
df.new <- getMasterdf_September(avg_time)
df.seasonal <- getSeasonality(df.new, avg_time)
plot.NV_conc_char(df.new, df.seasonal, df.specs, avg_time)
avg_time = 1
# df.new <- get_ts_master_dataFrame('Raw Sensor Data/Wind_direction_corr_IISc_1_20.csv',
#                               'Raw Sensor Data/Climo_co_corr_IISc_1_10.csv',
#                               'Raw Sensor Data/Wind_speed_corr_IISc_1_20.csv',
#                               avg_time)
df.new <- getMasterdf_September(avg_time)
df.new$sea <- rep(df.seasonal$conc, nrow(df.new)/(24/avg_time))
df.new$desea <- df.new$conc - df.new$sea
# df.new <- df.new[complete.cases(df.new), ]
hour.set <- 0:23
desea.xts <- xts(df.new$desea, order.by = as.POSIXct(df.new$time))
conc.xts <- xts(df.new$conc, order.by = as.POSIXct(df.new$time))
desea.split <- split(desea.xts, f = "hours")
conc.split <- split(conc.xts, f = "hours")
len = length(desea.split)
desea.var.1hr <- array(0, len)
conc.var.1hr <- array(0, len)
conc.1hr <- array(0, len)
desea <- array(0, len)
time.day <- array(0, len)#.POSIXct(character(len))
for(i in 1:length(desea.split)){
desea.var.1hr[i] = var(desea.split[[i]])
conc.var.1hr[i] = var(conc.split[[i]])
desea[i] = mean(desea.split[[i]])
conc.1hr[i] = mean(conc.split[[i]])
time.day[i] <- hour(start(conc.split[[i]]))
}
df.var.1 <- data.frame(time = time.day, conc = conc.1hr, de.var = desea.var.1hr, conc.var = conc.var.1hr)
df.var.2 <- data.frame(time = time.day, desea = desea, de.var = desea.var.1hr, conc.var = conc.var.1hr)
ggplot(df.var.2, aes(x = time, y = desea)) + geom_point(size = 1.5) + geom_line(aes(x = time, y = desea.var))
df.new$sea <- rep(df.seasonal$conc, nrow(df.new)/(24/avg_time))
df.new$desea <- df.new$conc - df.new$sea
# df.new <- df.new[complete.cases(df.new), ]
hour.set <- 0:23
desea.xts <- xts(df.new$desea, order.by = as.POSIXct(df.new$time))
conc.xts <- xts(df.new$conc, order.by = as.POSIXct(df.new$time))
desea.split <- split(desea.xts, f = "hours")
conc.split <- split(conc.xts, f = "hours")
len = length(desea.split)
desea.var.1hr <- array(0, len)
conc.var.1hr <- array(0, len)
conc.1hr <- array(0, len)
desea <- array(0, len)
time.day <- array(0, len)#.POSIXct(character(len))
for(i in 1:length(desea.split)){
desea.var.1hr[i] = var(desea.split[[i]])
conc.var.1hr[i] = var(conc.split[[i]])
desea[i] = mean(desea.split[[i]])
conc.1hr[i] = mean(conc.split[[i]])
time.day[i] <- hour(start(conc.split[[i]]))
}
df.var.1 <- data.frame(time = time.day, conc = conc.1hr, de.var = desea.var.1hr, conc.var = conc.var.1hr)
df.var.2 <- data.frame(time = time.day, desea = desea, de.var = desea.var.1hr, conc.var = conc.var.1hr)
avg_time <- 1/6
df.specs = "NV_conc_char"
df.new <- getMasterdf_September(avg_time)
df.seasonal <- getSeasonality(df.new, avg_time)
df.new$sea <- rep(df.seasonal$conc, nrow(df.new)/(24/avg_time))
df.new$desea <- df.new$conc - df.new$sea
# df.new <- df.new[complete.cases(df.new), ]
hour.set <- 0:23
desea.xts <- xts(df.new$desea, order.by = as.POSIXct(df.new$time))
conc.xts <- xts(df.new$conc, order.by = as.POSIXct(df.new$time))
desea.split <- split(desea.xts, f = "hours")
conc.split <- split(conc.xts, f = "hours")
len = length(desea.split)
desea.var.1hr <- array(0, len)
conc.var.1hr <- array(0, len)
View(desea.split)
conc.1hr <- array(0, len)
desea <- array(0, len)
time.day <- array(0, len)#.POSIXct(character(len))
for(i in 1:length(desea.split)){
desea.var.1hr[i] = var(desea.split[[i]])
conc.var.1hr[i] = var(conc.split[[i]])
desea[i] = mean(desea.split[[i]])
conc.1hr[i] = mean(conc.split[[i]])
time.day[i] <- hour(start(conc.split[[i]]))
}
df.var.1 <- data.frame(time = time.day, conc = conc.1hr, de.var = desea.var.1hr, conc.var = conc.var.1hr)
df.var.2 <- data.frame(time = time.day, desea = desea, de.var = desea.var.1hr, conc.var = conc.var.1hr)
ggplot(df.var.2, aes(x = time, y = desea)) + geom_point(size = 1.5) + geom_line(aes(x = time, y = desea.var))
ggplot(df.var.2, aes(x = time, y = desea)) + geom_point(size = 1.5) + geom_line(aes(x = time, y = de.var))
source('B:/Work/Robert Bosch Center/Sensor data/Time Series/repo/src/plotting_functions.R')
ggplot(df.var.1, aes(x = time, y = conc)) + geom_point(size = 1.5) + geom_line(aes(x = time, y = conc.var))
ggplot(df.var.1, aes(x = time, y = conc)) + geom_point(size = 1.5) + geom_line(aes(x = time, y = conc.var))
source('B:/Work/Robert Bosch Center/Sensor data/Time Series/repo/src/plotting_functions.R')
de.conc <- array(0, 24)
ql.dc <- array(0,24)
qh.dc <- array(0,24)
ql.c <- array(0,24)
qh.c <- array(0,24)
conc <- array(0, 24)
hour.set <- 0:23
df.var.2 <- df.var.2[complete.cases(df.var.2), ]
for(i in hour.set){
conc[i+1] <- mean(df.var.2$conc.var[df.var.2$time == i])
ql.c[i+1] <- quantile(df.var.2$conc.var[df.var.2$time == i], 0.05)
qh.c[i+1] <- quantile(df.var.2$conc.var[df.var.2$time == i], 0.95)
de.conc[i+1] <- mean(df.var.2$de.var[df.var.2$time == i])
ql.dc[i+1] <- quantile(df.var.2$de.var[df.var.2$time == i], 0.05)
qh.dc[i+1] <- quantile(df.var.2$de.var[df.var.2$time == i], 0.95)
}
tmp.1 <- data.frame(time = 0:23, Conc = conc, de.Conc = de.conc)#, ql.c = ql.c, ql.dc = ql.dc, qh.c = qh.c, qh.dc= qh.dc)
tmp <- melt(tmp.1, id = "time")
# dev.new(width=6, height=3)
plt <- ggplot(tmp, aes(x = time, y  = value ,color = variable)) +
geom_line(size= 2)+
#geom_line(aes(x = time, y = de.conc)) +
ylab("Variance") + xlab("Time of Day (Hours)") + labs(color = "")+
# ggtitle("Variance by Time of Day") +
theme_grey(base_size = 15) + theme(legend.position="bottom", legend.box = "horizontal")+
scale_colour_manual(values =c("Conc" = "brown2", "de.Conc" = "cyan"),
labels = c("Concentrations", "De-seasoned concentrations"))
plt
# dev.new(width=6, height=3)
plt <- ggplot(tmp, aes(x = time, y  = value ,color = variable)) +
geom_line(size= 2)+
#geom_line(aes(x = time, y = de.conc)) +
ylab("Variance") + xlab("Time of Day (Hours)") + labs(color = "")+
# ggtitle("Variance by Time of Day") +
theme_grey(base_size = 15) + theme(legend.position="bottom", legend.box = "horizontal")+
scale_colour_manual(values =c("Conc" = "red", "de.Conc" = "blue"),
labels = c("Concentrations", "De-seasoned concentrations"))+
geom_point(data = df.var.2, aes(x = 0:23, y = desea))
plt
hour.set <- 0:23
df.var.2 <- df.var.2[complete.cases(df.var.2), ]
for(i in hour.set){
conc[i+1] <- mean(df.var.2$conc.var[df.var.2$time == i])
ql.c[i+1] <- quantile(df.var.2$conc.var[df.var.2$time == i], 0.05)
qh.c[i+1] <- quantile(df.var.2$conc.var[df.var.2$time == i], 0.95)
de.conc[i+1] <- mean(df.var.2$de.var[df.var.2$time == i])
ql.dc[i+1] <- quantile(df.var.2$de.var[df.var.2$time == i], 0.05)
qh.dc[i+1] <- quantile(df.var.2$de.var[df.var.2$time == i], 0.95)
}
tmp.1 <- data.frame(time = 0:23, Conc = conc, de.Conc = de.conc)#, ql.c = ql.c, ql.dc = ql.dc, qh.c = qh.c, qh.dc= qh.dc)
tmp <- melt(tmp.1, id = "time")
# dev.new(width=6, height=3)
plt <- ggplot(tmp, aes(x = time, y  = value ,color = variable)) +
geom_line(size= 2)+
#geom_line(aes(x = time, y = de.conc)) +
ylab("Variance") + xlab("Time of Day (Hours)") + labs(color = "")+
# ggtitle("Variance by Time of Day") +
theme_grey(base_size = 15) + theme(legend.position="bottom", legend.box = "horizontal")+
scale_colour_manual(values =c("Conc" = "red", "de.Conc" = "blue"),
labels = c("Concentrations", "De-seasoned concentrations"))+
geom_point(data = df.var.2, aes(x = 0:23, y = desea))
plt
View(tmp)
head(tmp)
# dev.new(width=6, height=3)
plt <- ggplot(tmp, aes(x = time, y  = value ,color = variable)) +
geom_line(size= 2)+
#geom_line(aes(x = time, y = de.conc)) +
ylab("Variance") + xlab("Time of Day (Hours)") + labs(color = "")+
# ggtitle("Variance by Time of Day") +
theme_grey(base_size = 15) + theme(legend.position="bottom", legend.box = "horizontal")+
scale_colour_manual(values =c("Conc" = "red", "de.Conc" = "blue"),
labels = c("Concentrations", "De-seasoned concentrations"))#+
plt
# dev.new(width=6, height=3)
plt <- ggplot(tmp, aes(x = time, y  = value ,color = variable)) +
geom_line(size= 2)+
#geom_line(aes(x = time, y = de.conc)) +
ylab("Variance") + xlab("Time of Day (Hours)") + labs(color = "")+
# ggtitle("Variance by Time of Day") +
theme_grey(base_size = 15) + theme(legend.position="bottom", legend.box = "horizontal")+
scale_colour_manual(values =c("Conc" = "red", "de.Conc" = "blue"),
labels = c("Concentrations", "De-seasoned concentrations"))+
geom_line(df.var.2, aes(x = 0:23, y = desea))
# dev.new(width=6, height=3)
plt <- ggplot(tmp, aes(x = time, y  = value ,color = variable)) +
geom_line(size= 2)+
#geom_line(aes(x = time, y = de.conc)) +
ylab("Variance") + xlab("Time of Day (Hours)") + labs(color = "")+
# ggtitle("Variance by Time of Day") +
theme_grey(base_size = 15) + theme(legend.position="bottom", legend.box = "horizontal")+
scale_colour_manual(values =c("Conc" = "red", "de.Conc" = "blue"),
labels = c("Concentrations", "De-seasoned concentrations"))+
geom_line(data = df.var.2, aes(x = time, y = desea))
plt
View(plt)
# dev.new(width=6, height=3)
plt <- ggplot(tmp, aes(x = time, y  = value ,color = variable)) +
geom_line(size= 2)+
#geom_line(aes(x = time, y = de.conc)) +
ylab("Variance") + xlab("Time of Day (Hours)") + labs(color = "")+
# ggtitle("Variance by Time of Day") +
theme_grey(base_size = 15) + theme(legend.position="bottom", legend.box = "horizontal")+
scale_colour_manual(values =c("Conc" = "red", "de.Conc" = "blue"),
labels = c("Concentrations", "De-seasoned concentrations"))+
geom_line(data = df.var.2, aes(x = time, y = desea))
geom_line(data = df.var.2, aes(x = time, y = desea))
# dev.new(width=6, height=3)
plt <- ggplot(tmp, aes(x = time, y  = value ,color = variable)) +
geom_line(size= 2)+
#geom_line(aes(x = time, y = de.conc)) +
ylab("Variance") + xlab("Time of Day (Hours)") + labs(color = "")+
# ggtitle("Variance by Time of Day") +
theme_grey(base_size = 15) + theme(legend.position="bottom", legend.box = "horizontal")+
scale_colour_manual(values =c("Conc" = "red", "de.Conc" = "blue"),
labels = c("Concentrations", "De-seasoned concentrations"))+
ggplot()+geom_line(data = df.var.2, aes(x = time, y = desea))
ggplot()+geom_line(data = df.var.2, aes(x = time, y = desea))
ggplot()+geom_line(data = df.var.2, aes(x = time, y = conc))
ggplot(data = df.var.2)+geom_line(aes(x = time, y = conc))
ggplot(data = df.var.2)+geom_point(aes(x = time, y = conc))
# dev.new(width=6, height=3)
plt <- ggplot(tmp, aes(x = time, y  = value ,color = variable)) +
geom_line(size= 2)+
#geom_line(aes(x = time, y = de.conc)) +
ylab("Variance") + xlab("Time of Day (Hours)") + labs(color = "")+
# ggtitle("Variance by Time of Day") +
theme_grey(base_size = 15) + theme(legend.position="bottom", legend.box = "horizontal")+
scale_colour_manual(values =c("Conc" = "red", "de.Conc" = "blue"),
labels = c("Concentrations", "De-seasoned concentrations"))
# dev.new(width=6, height=3)
plt <- ggplot(tmp, aes(x = time, y  = value ,color = variable)) +
geom_line(size= 2)+
#geom_line(aes(x = time, y = de.conc)) +
ylab("Variance") + xlab("Time of Day (Hours)") + labs(color = "")+
# ggtitle("Variance by Time of Day") +
theme_grey(base_size = 15) + theme(legend.position="bottom", legend.box = "horizontal")+
scale_colour_manual(values =c("Conc" = "red", "de.Conc" = "blue"),
labels = c("Concentrations", "De-seasoned concentrations"))+
geom_point(aes(x = df.var.1$time, y = conc))
plt
# dev.new(width=6, height=3)
plt <- ggplot(tmp, aes(x = time, y  = value ,color = variable)) +
geom_line(size= 2)+
#geom_line(aes(x = time, y = de.conc)) +
ylab("Variance") + xlab("Time of Day (Hours)") + labs(color = "")+
# ggtitle("Variance by Time of Day") +
theme_grey(base_size = 15) + theme(legend.position="bottom", legend.box = "horizontal")+
scale_colour_manual(values =c("Conc" = "red", "de.Conc" = "blue"),
labels = c("Concentrations", "De-seasoned concentrations"))+
geom_point(aes(x = df.var.1$time, y = df.var.1$conc))
plt
# dev.new(width=6, height=3)
(plt <- ggplot(tmp, aes(x = time, y  = value ,color = variable)) +
geom_line(size= 2)+
#geom_line(aes(x = time, y = de.conc)) +
ylab("Variance") + xlab("Time of Day (Hours)") + labs(color = "")+
# ggtitle("Variance by Time of Day") +
theme_grey(base_size = 15) + theme(legend.position="bottom", legend.box = "horizontal")+
scale_colour_manual(values =c("Conc" = "red", "de.Conc" = "blue"),
labels = c("Concentrations", "De-seasoned concentrations"))+
geom_point(aes(x = df.var.1$time, y = df.var.1$conc))
)
# dev.new(width=6, height=3)
(plt <- ggplot(tmp, aes(x = time, y  = value ,color = variable)) +
geom_line(size= 2)+
#geom_line(aes(x = time, y = de.conc)) +
ylab("Variance") + xlab("Time of Day (Hours)") + labs(color = "")+
# ggtitle("Variance by Time of Day") +
theme_grey(base_size = 15) + theme(legend.position="bottom", legend.box = "horizontal")+
scale_colour_manual(values =c("Conc" = "red", "de.Conc" = "blue"),
labels = c("Concentrations", "De-seasoned concentrations"))+
geom_point(data = df.var.1, aes(x = time, y = conc))
)
View(tmp)
# dev.new(width=6, height=3)
(plt <- ggplot(data = tmp, aes(x = time, y  = value ,color = variable)) +
geom_line(size= 2)+
#geom_line(aes(x = time, y = de.conc)) +
ylab("Variance") + xlab("Time of Day (Hours)") + labs(color = "")+
# ggtitle("Variance by Time of Day") +
theme_grey(base_size = 15) + theme(legend.position="bottom", legend.box = "horizontal")+
scale_colour_manual(values =c("Conc" = "red", "de.Conc" = "blue"),
labels = c("Concentrations", "De-seasoned concentrations"))+
geom_point(data = df.var.1, aes(x = time, y = conc))
)
tmp
tmp
df.new$sea <- rep(df.seasonal$conc, nrow(df.new)/(24/avg_time))
df.new$desea <- df.new$conc - df.new$sea
# df.new <- df.new[complete.cases(df.new), ]
hour.set <- 0:23
desea.xts <- xts(df.new$desea, order.by = as.POSIXct(df.new$time))
conc.xts <- xts(df.new$conc, order.by = as.POSIXct(df.new$time))
desea.split <- split(desea.xts, f = "hours")
conc.split <- split(conc.xts, f = "hours")
len = length(desea.split)
desea.var.1hr <- array(0, len)
conc.var.1hr <- array(0, len)
conc.1hr <- array(0, len)
desea <- array(0, len)
time.day <- array(0, len)#.POSIXct(character(len))
for(i in 1:length(desea.split)){
desea.var.1hr[i] = var(desea.split[[i]])
conc.var.1hr[i] = var(conc.split[[i]])
desea[i] = mean(desea.split[[i]])
conc.1hr[i] = mean(conc.split[[i]])
time.day[i] <- hour(start(conc.split[[i]]))
}
df.var.1 <- data.frame(time = time.day, conc = conc.1hr, de.var = desea.var.1hr, conc.var = conc.var.1hr)
df.var.2 <- data.frame(time = time.day, desea = desea, de.var = desea.var.1hr, conc.var = conc.var.1hr)
p.char1 <- ggplot(df.var.2, aes(x=desea,y=de.var)) +
geom_point(size = 1.5) +  xlim(-1, 1.5) + ylab(expression(paste(sigma,'(De-seasoned Concentrations)')))+
xlab("Deseasoned Concentrations")+ theme_grey(base_size = 13)
p.char2 <- ggplot(df.var.1, aes(x=conc,y=conc.var)) +
geom_point(size = 1.5) +
xlab("Concentrations") + ylab(expression(paste(sigma,'(Concentrations)')))+
theme_grey(base_size = 13) # + stat_smooth(method = "loess")
# p4 <- ggplot(df.var.2, aes(x=desea,y=conc.var)) +
#   geom_point(size = 1.5) +
#   ylab("") + ylim(0, 1) + theme_grey(base_size = 13)#+ stat_smooth(method = "loess")
plt <- plot_grid(p.char1, p.char2, nrow = 2)
# title <- ggdraw() + draw_label("Noise Variance and Concentration Characteristics")
# plt<- plot_grid(title, p, ncol=1, rel_heights=c(0.1, 1)) # rel_heights values control title margins
plot.folder <- paste(folder,"/NV_conc_char/", sep="")
dir.create(plot.folder, showWarnings=FALSE, recursive=TRUE)
for(format in formats){
plot.filename <- paste(plot.folder,"dfName=",df.specs,".",format,sep="")
if(!is.na(format)){
if(format=="PDF")
pdf(file=plot.filename,bg="white")
else if(format=="PNG")
png(filename=plot.filename,width=800,height=800,units="px",pointsize=20,bg="white")
}
print(plt) #suppressMessages(print(plt))
if(!is.na(format))
dev.off()
}
print(plt)
de.conc <- array(0, 24)
ql.dc <- array(0,24)
qh.dc <- array(0,24)
ql.c <- array(0,24)
qh.c <- array(0,24)
conc <- array(0, 24)
hour.set <- 0:23
df.var.2 <- df.var.2[complete.cases(df.var.2), ]
for(i in hour.set){
conc[i+1] <- mean(df.var.2$conc.var[df.var.2$time == i])
ql.c[i+1] <- quantile(df.var.2$conc.var[df.var.2$time == i], 0.05)
qh.c[i+1] <- quantile(df.var.2$conc.var[df.var.2$time == i], 0.95)
de.conc[i+1] <- mean(df.var.2$de.var[df.var.2$time == i])
ql.dc[i+1] <- quantile(df.var.2$de.var[df.var.2$time == i], 0.05)
qh.dc[i+1] <- quantile(df.var.2$de.var[df.var.2$time == i], 0.95)
}
tmp.1 <- data.frame(time = 0:23, Conc = conc, de.Conc = de.conc)#, ql.c = ql.c, ql.dc = ql.dc, qh.c = qh.c, qh.dc= qh.dc)
tmp <- melt(tmp.1, id = "time")
# dev.new(width=6, height=3)
tmp
tmp.1
tmp <- melt(tmp.1, id = "time")
tmp
tmp.1 <- data.frame(time = 0:23, Conc = conc, de.Conc = de.conc)#, ql.c = ql.c, ql.dc = ql.dc, qh.c = qh.c, qh.dc= qh.dc)
tmp <- melt(tmp.1, id = "time")
tmp
tmp <- melt(cbind(tmp.1[1], as.matrix(tmp.1[-1])), id = "time")
View(tmp)
# dev.new(width=6, height=3)
(plt <- ggplot(data = tmp, aes(x = time, y  = value ,color = variable)) +
geom_line(size= 2)+
#geom_line(aes(x = time, y = de.conc)) +
ylab("Variance") + xlab("Time of Day (Hours)") + labs(color = "")+
# ggtitle("Variance by Time of Day") +
theme_grey(base_size = 15) + theme(legend.position="bottom", legend.box = "horizontal")+
scale_colour_manual(values =c("Conc" = "red", "de.Conc" = "blue"),
labels = c("Concentrations", "De-seasoned concentrations"))+
geom_point(data = df.var.1, aes(x = time, y = conc))
)
# dev.new(width=6, height=3)
(plt <- ggplot(data = tmp, aes(x = time, y  = value ,color = variable)) +
geom_line(size= 2)+
#geom_line(aes(x = time, y = de.conc)) +
ylab("Variance") + xlab("Time of Day (Hours)") + labs(color = "")+
# ggtitle("Variance by Time of Day") +
theme_grey(base_size = 15) + theme(legend.position="bottom", legend.box = "horizontal")+
scale_colour_manual(values =c("Conc" = "red", "de.Conc" = "blue"),
labels = c("Concentrations", "De-seasoned concentrations"))
# +geom_point(data = df.var.1, aes(x = time, y = conc))
)
plt
plt + ggplot(df.var.1, aes(x = time, y = conc)) + geom_point()
plt + geom_point(data = df.var.1, aes(x = time, y = conc))
ggplot(data = df.var.1, aes(x = time, y = conc)) + geom_point()
ggplot(data = df.var.1, aes(x = time, y = conc)) + geom_point(size = 2) + geom_line()
ggplot(df.var.2, aes(x = time, y = desea)) + geom_point(size = 1.5) + geom_line(aes(x = time, y = de.var))
ggplot(df.var.2, aes(x = time, y = desea)) + geom_point(size = 1.5)+
stat_summary(aes(y = value,group=1), fun.y=mean, colour="red", geom="line",group=1)
ggplot(df.var.2, aes(x = time, y = desea)) + geom_point(size = 1.5)+
stat_summary(aes(y = desea, group=1), fun.y=mean, colour="red", geom="line",group=1)
ggplot(df.var.2, aes(x = time, y = desea)) + geom_point(size = 1.5)+
stat_summary(aes(y = desea, group=1), fun.y=mean, colour="red", geom="line",group=1, size = 1)
ggplot(df.var.2, aes(x = time, y = desea)) + geom_point(size = 1.5)+ ylim(-0.5, 0.5)+
stat_summary(aes(y = desea, group=1), fun.y=mean, colour="red", geom="line",group=1, size = 1)
ggplot(df.var.1, aes(x = time, y = conc)) + geom_point(size = 1.5)+ #ylim(-0.5, 0.5)+
stat_summary(aes(y = conc, group=1), fun.y=mean, colour="red", geom="line",group=1, size = 1)
ggplot(df.var.2, aes(x = time, y = desea)) + geom_point(size = 1.5)+ ylim(-0.5, 0.5)+
stat_summary(aes(y = desea, group=1), fun.y=mean, colour="red", geom="line",group=1, size = 1)
ggplot(df.var.2, aes(x = time, y = de.var)) + geom_point(size = 1.5)+ ylim(-0.5, 0.5)+
stat_summary(aes(y = desea, group=1), fun.y=mean, colour="red", geom="line",group=1, size = 1)
ggplot(df.var.2, aes(x = time, y = de.var)) + geom_point(size = 1.5)+ ylim(-0.5, 0.5)+
stat_summary(aes(y = de.var, group=1), fun.y=mean, colour="red", geom="line",group=1, size = 1)
ggplot(df.var.2, aes(x = time, y = de.var)) + geom_point(size = 1.5)+
stat_summary(aes(y = de.var, group=1), fun.y=mean, colour="red", geom="line",group=1, size = 1)
ggplot(df.var.1, aes(x = time, y = conc.var)) + geom_point(size = 1.5)+ #ylim(-0.5, 0.5)+
stat_summary(aes(y = conc.var, group=1), fun.y=mean, colour="red", geom="line",group=1, size = 1)
ggplot(df.var.1, aes(x = time, y = conc.var)) + geom_point(size = 1.5,alpha = 0.05)+ #ylim(-0.5, 0.5)+
stat_summary(aes(y = conc.var, group=1), fun.y=mean, colour="red", geom="line",group=1, size = 1)
ggplot(df.var.1, aes(x = time, y = conc.var)) + geom_point(size = 1.5,alpha = 0.5, color = "red")+ #ylim(-0.5, 0.5)+
stat_summary(aes(y = conc.var, group=1), fun.y=mean, colour="red", geom="line",group=1, size = 1)
ggplot(df.var.1, aes(x = time, y = conc.var)) + geom_point(size = 1.5,alpha = 0.5, color = "red")+ #ylim(-0.5, 0.5)+
stat_summary(aes(y = conc.var, group=1), fun.y=mean, colour="red", geom="line",group=1, size = 1)+
geom_point(data = df.var.2, aes(x = time, y = de.var, size = 1.5, alpha = 0.5, color = "blue"))+
stat_summary(aes(y = de.var, group=1), fun.y=mean, colour="blue", geom="line",group=1, size = 1)
ggplot(df.var.1, aes(x = time, y = conc.var)) + geom_point(size = 1.5,alpha = 0.5, color = "red")+ #ylim(-0.5, 0.5)+
stat_summary(aes(y = conc.var, group=1), fun.y=mean, colour="red", geom="line",group=1, size = 1)+
geom_point(data = df.var.2, aes(x = time, y = de.var), size = 1.5, alpha = 0.5, color = "blue")+
stat_summary(aes(y = de.var, group=1), fun.y=mean, colour="blue", geom="line",group=1, size = 1)
ggplot(df.var.1, aes(x = time, y = conc.var)) + geom_point(size = 1.5,alpha = 0.5, color = "red")+ #ylim(-0.5, 0.5)+
stat_summary(aes(y = conc.var, group=1), fun.y=mean, colour="red", geom="line",group=1, size = 1)+
geom_point(data = df.var.2, aes(x = time, y = de.var), size = 1.5, alpha = 0.5, color = "blue")+
stat_summary(aes(y = de.var, group=1), fun.y=mean, colour="blue", geom="line",group=1, size = 1)+
scale_colour_manual(values =c("Conc" = "red", "de.Conc" = "blue"),
labels = c("Concentrations", "De-seasoned concentrations"))
df.final <- data.frame(time = time.day, de.var = desea.var.1hr, conc.var = conc.var.1hr)
df.final.m <- melt(df.final, id.vars = "time")
View(df.final.m)
df.final.m <- melt(cbind(df.final[1], as.matrix(df.final[-1])), id = "time")
head(df.final)
df.final.m <- melt(cbind(df.final[1], as.matrix(df.final[-1])), id = "time")
head(df.final.m)
ggplot(df.final, aes( x = time, y = value, color = type))+geom_point(size = 1)
ggplot(df.final.m, aes( x = time, y = value, color = type))+geom_point(size = 1)
ggplot(df.final.m, aes( x = time, y = value, color = variable))+geom_point(size = 1)
ggplot(df.final.m, aes( x = time, y = value, color = variable))+geom_point(size = 1, alpha = 0.5)+
scale_colour_manual(values =c("Conc" = "red", "de.Conc" = "blue"),
labels = c("Concentrations", "De-seasoned concentrations"))
ggplot(df.final.m, aes( x = time, y = value, color = variable))+geom_point(size = 1, alpha = 0.5)
ggplot(df.final.m, aes( x = time, y = value, color = variable))+geom_point(size = 1, alpha = 0.5)+
stat_summary(aes(y = value, group=1), fun.y=mean, colour="red", geom="line",group=1, size = 1)
ggplot(df.var.1, aes(x = time, y = conc.var)) + geom_point(size = 1.5,alpha = 0.5, color = "red")+ #ylim(-0.5, 0.5)+
stat_summary(aes(y = conc.var, group=1), fun.y=mean, colour="red", geom="line",group=1, size = 1)
ggplot(df.var.1, aes(x = time, y = conc.var)) + geom_point(size = 1.5,alpha = 0.5, color = "black")+ #ylim(-0.5, 0.5)+
stat_summary(aes(y = conc.var, group=1), fun.y=mean, colour="black", geom="line",group=1, size = 1)
ggplot(df.var.2, aes(x = time, y = de.var)) +  geom_point(size = 1.5,alpha = 0.5, color = "black")+ #ylim(-0.5, 0.5)+
stat_summary(aes(y = de.var, group=1), fun.y=mean, colour="black", geom="line",group=1, size = 1)
ggplot(df.var.1, aes(x = time, y = conc.var)) + geom_point(size = 1.5,alpha = 0.5, color = "black")+ #ylim(-0.5, 0.5)+
stat_summary(aes(y = conc.var, group=1), fun.y=mean, colour="black", geom="line",group=1, size = 1)
ggplot(df.var.2, aes(x = time, y = de.var)) +  geom_point(size = 1.5,alpha = 0.5, color = "black")+ #ylim(-0.5, 0.5)+
stat_summary(aes(y = de.var, group=1), fun.y=mean, colour="black", geom="line",group=1, size = 1)
ggplot(df.var.1, aes(x = time, y = conc.var)) + geom_point(size = 1.5,alpha = 0.5, color = "black")+ #ylim(-0.5, 0.5)+
stat_summary(aes(y = conc.var, group=1), fun.y=mean, colour="black", geom="line",group=1, size = 1)
ggplot(df.var.1, aes(x = time, y = conc.var)) + geom_point(size = 1.5,alpha = 0.5, color = "black")+ #ylim(-0.5, 0.5)+
stat_summary(aes(y = conc.var, group=1), fun.y=mean, colour="black", geom="line",group=1, size = 1)
source('B:/Work/Robert Bosch Center/Sensor data/Time Series/repo/src/plotting_functions.R')
source('B:/Work/Robert Bosch Center/Sensor data/Time Series/repo/src/plotting_functions.R')
p1 <- ggplot(df.var.2, aes(x = time, y = de.var)) +  geom_point(size = 1.5,alpha = 0.5, color = "black")+ #ylim(-0.5, 0.5)+
stat_summary(aes(y = de.var, group=1), fun.y=mean, colour="black", geom="line",group=1, size = 1)+
xlab("")+ylab(expression(paste(sigma,'(De-seasoned Concentrations)')))
p2 <- ggplot(df.var.1, aes(x = time, y = conc.var)) + geom_point(size = 1.5,alpha = 0.5, color = "black")+ #ylim(-0.5, 0.5)+
stat_summary(aes(y = conc.var, group=1), fun.y=mean, colour="black", geom="line",group=1, size = 1)+
xlab("Time of day (Hours)")+ylab(expression(paste(sigma,'(Concentrations)')))
p1 <- ggplot(df.var.2, aes(x = time, y = de.var)) +  geom_point(size = 1.5,alpha = 0.5, color = "black")+ #ylim(-0.5, 0.5)+
stat_summary(aes(y = de.var, group=1), fun.y=mean, colour="black", geom="line",group=1, size = 1)+
xlab("")+ylab(expression(paste(sigma,'(De-seasoned Concentrations)')))
p2 <- ggplot(df.var.1, aes(x = time, y = conc.var)) + geom_point(size = 1.5,alpha = 0.5, color = "black")+ #ylim(-0.5, 0.5)+
stat_summary(aes(y = conc.var, group=1), fun.y=mean, colour="black", geom="line",group=1, size = 1)+
xlab("Time of day (Hours)")+ylab(expression(paste(sigma,'(Concentrations)')))
plt <- plot_grid(p1, p2, nrow = 2)
plt
source('B:/Work/Robert Bosch Center/Sensor data/Time Series/repo/src/plotting_functions.R')
tmp <- avg_time
avg_time <- 1/6
df.specs = "NV_conc_char"
df.new <- getMasterdf_September(avg_time)
df.seasonal <- getSeasonality(df.new, avg_time)
plot.NV_conc_char(df.new, df.seasonal, df.specs, avg_time)
avg_time = 1
# df.new <- get_ts_master_dataFrame('Raw Sensor Data/Wind_direction_corr_IISc_1_20.csv',
#                               'Raw Sensor Data/Climo_co_corr_IISc_1_10.csv',
#                               'Raw Sensor Data/Wind_speed_corr_IISc_1_20.csv',
#                               avg_time)
df.new <- getMasterdf_September(avg_time)
